# 2. Memory: Ingestion

<pre>
â”œâ”€â”€ <a href="../README.md">..</a>
â”œâ”€â”€ <a href="./1.MEMORY.md">1. Memory</a>
â”œâ”€â”€ <span><a href="./2.INGESTION.md"><b>2. Ingestion</b></a> ðŸ‘ˆ</span>
|   â”œâ”€â”€ <a href="#21-score">2.1 Score</a>
|   â”œâ”€â”€ <a href="#22-classify">2.2 Classify</a>
|   â””â”€â”€ <a href="#23-store">2.3 Store</a>
â”œâ”€â”€ <a href="./3.GUARDS.md">3. Guards</a>
â””â”€â”€ <a href="./4.RECALL.md">4. Recall</a>
</pre>

**Memory Ingestion** is the process of transforming raw conversational text into a structured object with metadata that will make similarity based retrieval possible.

```mermaid
---
title: Memory Ingestion
---

flowchart TB
  %% Start / End
  START(( ))
  END(( ))

  %% Core stages
  Ingest([Ingest])
  Guards@{ shape: hex, label: "<a href='https://github.com/aacebo/merc/blob/main/docs/3.GUARDS.md'>Guards</a>" }
  Score([Score])
  Drop([Drop])
  Classify([Classify])

  %% Memory types
  Episodic(["<a href='https://github.com/aacebo/merc/blob/main/docs/1.MEMORY.md#episodic-events'>Episodic</a>"])
  Semantic(["<a href='https://github.com/aacebo/merc/blob/main/docs/1.MEMORY.md#semantic-facts-concepts'>Semantic</a>"])
  Procedural(["<a href='https://github.com/aacebo/merc/blob/main/docs/1.MEMORY.md#procedural-skills-habits'>Procedural</a>"])
  Emotional(["<a href='https://github.com/aacebo/merc/blob/main/docs/1.MEMORY.md#emotional'>Emotional</a>"])
  Working(["<a href='https://github.com/aacebo/merc/blob/main/docs/1.MEMORY.md#working-temporary'>Working</a>"])

  %% Post-processing
  Store@{ shape: cyl, label: 'Store' }
  Recall(["<a href="https://github.com/aacebo/merc/blob/main/docs/4.RECALL.md">Recall</a>"])
  Reinforce([Reinforce])
  Reclassify([Reclassify])

  %% Flow
  START e1@--> Ingest
  e1@{ animate: true }

  Ingest e2@--> Guards
  e2@{ animate: true }

  Guards e3@-->|salience + emotion + meaning + context| Score
  e3@{ animate: true }

  Score -->|below threshold| Drop
  Drop --> END

  Score e4@-->|above threshold| Classify
  e4@{ animate: true }

  Classify e5@--> Episodic
  Classify e6@--> Semantic
  e6@{ animate: true }

  Classify e7@--> Procedural
  Classify e8@--> Emotional
  Classify e9@--> Working

  Episodic e10@--> Store
  Semantic e11@--> Store
  e11@{ animate: true }

  Procedural e12@--> Store
  Emotional e13@--> Store
  Working e14@--> Store

  Store e15@--> Recall
  e15@{ animate: true }

  Recall e16@--> Reinforce
  e16@{ animate: true }

  Reinforce e17@--> Reclassify
  e17@{ animate: true }

  Reclassify e18@--> Store
  e18@{ animate: true }

  %% --- Global link style: dotted ---
  linkStyle default stroke-width:2px,stroke-dasharray:4 4;

  %% --- Styling for the "Classify" node + path ---
  classDef success color:#ffffff,stroke:#118a11,fill:#0e5904;
  class Classify success;

  %% --- Styling for the "Drop" node + path ---
  classDef error color:#ffffff,stroke:#cc0000,fill:#660000;
  class Drop error;
  class END error;

  %% Override the Drop path links back to red (0-based edge indices)
  linkStyle 3 stroke:#cc0000,stroke-width:2px;
  linkStyle 4 stroke:#cc0000,stroke-width:2px;
  linkStyle 5 stroke:#118a11,stroke-width:2px;
  linkStyle 7 stroke:#118a11,stroke-width:2px;
  linkStyle 12 stroke:#118a11,stroke-width:2px;
  linkStyle 16 stroke:#118a11,stroke-width:2px;
  linkStyle 17 stroke:#118a11,stroke-width:2px;
  linkStyle 18 stroke:#118a11,stroke-width:2px;
  linkStyle 19 stroke:#118a11,stroke-width:2px;
```

## 2.1 Scoring

By measuring the input using a classifier against our significant [datapoints](./1.MEMORY.md#14-datapoints), we can create a weighted score.

If said score is *under* our threshold, it is not worth remembering. Otherwise we continue on to further classification.

## 2.2 Classification

## 2.3 Storage

